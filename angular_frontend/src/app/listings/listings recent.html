<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<!-- <div style="margin: 20px;" *ngIf="user.isLoggedIn()">
    <div class="row" *ngIf="filteredListings() as lst">
        <div class="top-row">
            <div class="searchbar">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-left:10px;margin-right:20px;">
                    <path d="M11 19C15.4183 19 19 15.4183 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19Z" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M21 21L16.65 16.65" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <input type="text" class="search-input" placeholder="Search listing">
            </div>


            <div style="display:flex; justify-content: center;align-items: center; margin-right:20px;">
            <div class="f-button" style="width:120px; margin-right:20px;" (click)="toggleDisplay()"> 
                <div>
                <div class="f-button-text" style="justify-content: center;align-items: center;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right:6px;margin-bottom:2px;">
                        <path d="M3 12H21" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3 6H21" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3 18H21" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Filters
                </div>
                </div>    

            </div>

            <div class="f-button"> 
                <div class="f-button-text">
                    <select  class="cus" id="orderBySelect" [(ngModel)]="sortCol">
                        <option  style="background-color:#2E3238;" *ngFor="let c of sortCols; let i = index" [value]="i">
                          {{c.name}}
                        </option>
                      </select>
                </div>    
            </div>
        </div>
        </div>

        <div style="width: 100%; display:flex; justify-content: right; z-index: 1;">
        <div class="filter-pane" [ngStyle]="{'display': displayDiv ? 'block' : 'none'}">
            <!-- Calendar -->
        <!-- <div style="display:flex; width:600px;">
        <div style="margin-left:20px;margin-right:20px;">
          <mat-card style=" width:400px;height:470px; background-color: #606163; color: #F2F2F2;">
            <mat-calendar
              id="calendar"
              [selected]="selected"
              style="color:white;"
              (selectedChange)="selected = $event">
            </mat-calendar>

            <button
            *ngIf="selected"
            type="button"
            class="btn btn-outline-danger btn-block"
            (click)="selected = null">
              Clear Date Selection
          </button>
          </mat-card>
        </div>

        <div class="filters-page">
        <mat-card style="width: 300px;padding-top: 10px">
            <label for="inputStartTimestamp">
              Start Time
            </label>
            <input
            type="time"
            min="00:00"
            max="24:00"
            class="form-control"
            [(ngModel)]="selectedStart">
          </mat-card>
          <mat-card style="width: 100%;padding-top: 10px">
            <label for="inputEndTimestamp">
              End Time
            </label>
            <input
            type="time"
            min="00:00"
            max="24:00"
            class="form-control"
            [(ngModel)]="selectedEnd">
            <button
            *ngIf="selectedEnd || selectedStart"
            type="button"
            (click)="selectedEnd = null; selectedStart=null;"
            class="btn btn-outline-danger btn-block"
            style="margin-top:10px;">
              Clear Time Selection
          </button>
          </mat-card>
          

          <mat-card style="width: 100%;padding-top: 10px">
            <label for="inputEndTimestamp">
              Artist
            </label>
            <ng-multiselect-dropdown
            [placeholder]="'Filter artist'"
            [settings]="dropdownSettings"
            [data]="dropdownList"
            [(ngModel)]="selectedItems"
            (onSelect)="onItemSelect($event)"
            (onSelectAll)="onSelectAll($event)"
            ></ng-multiselect-dropdown>
          </mat-card>
        <mat-card style="width: 100%;padding-top: 10px">
            <label for="inputEndTimestamp">
              Genre
            </label>
            <ng-multiselect-dropdown
            [placeholder]="'Filter genres'"
            [settings]="dropdownSettings"
            [data]="dropdownList"
            [(ngModel)]="selectedItems"
            (onSelect)="onItemSelect($event)"
            (onSelectAll)="onSelectAll($event)"
            ></ng-multiselect-dropdown>
          </mat-card>

        </div>
        </div>
    </div>

</div>
    </div> 
</div> -->



<div class="listing-container" *ngIf="filteredListings() as lst">
    <div class="top-row">
        <div class="searchbar">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-left:10px;margin-right:20px;">
                <path d="M11 19C15.4183 19 19 15.4183 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19Z" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M21 21L16.65 16.65" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <input type="text" class="search-input" placeholder="Search listing">
        </div>


        <div style="display:flex; justify-content: center;align-items: center; margin-right:20px;">
        <div class="f-button" style="width:120px; margin-right:20px;" (click)="toggleDisplay()"> 
            <div>
            <div class="f-button-text" style="justify-content: center;align-items: center;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right:6px;margin-bottom:2px;">
                    <path d="M3 12H21" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M3 6H21" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M3 18H21" stroke="#F2F2F2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Filters
            </div>
            </div>    

        </div>

        <div class="f-button"> 
            <div class="f-button-text">
                <select  class="cus" id="orderBySelect" [(ngModel)]="sortCol">
                    <option  style="background-color:#2E3238;" *ngFor="let c of sortCols; let i = index" [value]="i">
                      {{c.name}}
                    </option>
                  </select>
            </div>    
        </div>
    </div>
    </div>

    <div class="row">
        <!-- Amount of results -->
        <div class="col">
          <p style="margin: 0px;"><i style="color:#d8d8d8;font-family:'Poppins';font-style: normal;font-weight: 600;">{{lst.length}} result{{(lst.length > 1 ? "s" : "")}} </i></p>
        </div>

        <!-- Template for page navigation -->
        <ng-template #pages>
          <div class="col-auto" *ngIf="lst.length > 0">
            <div class="row">

              <!-- Items per page selector -->
              <div class="col-auto">
                <div class="form-group">

                  <label for="itemsPerPage" style="margin-right: 3px;">
                    Items Per Page:
                  </label>

                  <!-- Radio -->
                  <div class="btn-group mr-2" role="group" aria-label="First group" id="itemsPerPage">
                    <button
                      *ngFor="let o of pageLimitOption; let i = index"
                      [class]="'btn btn' + (pageLimitIndex === i ? '': '-outline') + '-secondary'"
                      (click)="pageLimitIndex = i; currentPage = 1">
                        {{o}}
                    </button>
                  </div>
                </div>
              </div>

              <!-- Page selector -->
              <div class="col-auto">
                <div class="input-group mb-3" id="currPage">

                  <!-- Decrement page nr button -->
                  <div class="input-group-prepend">
                    <button
                      class="btn btn-outline-secondary"
                      (click)="currentPage = currentPage !== 1 ? currentPage - 1 : currentPage">
                        &#60;
                    </button>
                  </div>

                  <!-- Page nr input -->
                  <input
                    type="number"
                    min=1
                    [max]="maxPage(lst)"
                    class="form-control"
                    [(ngModel)]="currentPage">

                  <!-- Increment page nr button -->
                  <div class="input-group-append">
                    <button
                      class="btn btn-outline-secondary"
                      (click)="currentPage = currentPage !== maxPage(lst) ? currentPage + 1 : currentPage">
                        &#62;
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
        <!-- Page navigation -->
        <ng-container *ngTemplateOutlet="pages"></ng-container>
      </div>
































      <div class="row" style="background:red; padding:10px;">
        <div class="col" *ngIf="pageLimitOption[pageLimitIndex] as pageLimit">

          <!-- Listings -->
          <div
            class="card"
            *ngFor="let l of lst.slice(pageLimit * (currentPage - 1), pageLimit * (currentPage - 1) + pageLimit)"
            style="margin-bottom: 5px;">

            <!-- Listing -->
            <div class="row no-gutters">

              <!-- Image -->
              <div class="col-auto" style="cursor:pointer;" [routerLink]="['/listings', 'details', l.listingID]">
                <img
                  class="card-img-left"
                  [src]="l.listingPicture ? l.listingPicture : image.getPlaceholderImage()"
                  style="width: 318px;height: 200;"
                  [alt]="l.title">
              </div>

              <!-- Listing info -->
              <div class="col">
                <div class="card-body">
                  <div class="row no-gutters">

                    <!-- Details -->
                    <div class="col" style="cursor:pointer;" [routerLink]="['/listings', 'details', l.listingID]">

                      <!-- Title -->
                      <h2 class="card-title">{{l.title}}
                        <b *ngIf="user.getId() === l.userID"> 🚩 </b>
                      </h2>

                      <!-- Listing Details -->
                      <div *ngIf="!transactions">

                        <!-- Rating -->
                        <div *ngIf="l.avgScore && l.reviewAmount">Rating:
                          <ngb-rating max=5 [(rate)]="l.avgScore" readonly="true">
                            <ng-template let-fill="fill" let-index="index">
                              <span [class]="'rating-star-back' + (fill === 100 ? '-filled' : '')">
                                <span class="rating-star-front" [style]="'width:' + fill + '%'">
                                  &#9733;
                                </span>
                                &#9733;
                              </span>
                            </ng-template>
                          </ngb-rating>
                          ({{l.reviewAmount}})
                        </div>

                        <div *ngIf="l.date">Date: <b>{{l.date}}</b></div>
                        <div *ngIf="l.location">Location: <b>{{l.location}}</b></div>
                        <div *ngIf="l.genre">genre(s): <b>{{l.genre}}</b></div>
                        <div *ngIf="l.artistType">artistTypes: <b>{{l.artistType}}</b></div>
                        <div *ngIf="l.startTime">Start time: <b>{{l.startTime}}</b></div>
                        <div *ngIf="l.endTime">End time: <b>{{l.endTime}}</b></div>
                      </div>
                    </div>

                    <!-- Price -->
                    <div class="col-auto">
                      <h2 ><i>€ {{l.suggestedPrice}}/hr</i></h2>
                      <br>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Review form (only for transactions) -->
            <div *ngIf="transactions && selectedTransactionForReview === l.transactionID" style="margin:10px">
              <form [formGroup]="form" (ngSubmit)="postReview()">

                <!-- Title + Rating -->
                <h2 class="display-4">
                  Review:
                  <!-- Rating -->
                  <ngb-rating max=5 [(rate)]="rating" (hover)="hoverRating = $event" (leave)="hoverRating = 0">
                    <ng-template let-fill="fill" let-index="index">
                      <span [style]="'font-size: 50px;color: ' + (index < hoverRating && index >= rating ? '#FAB81E': index < hoverRating ? 'orange' : index >= rating ? 'gray' : '#FFC300')">
                        &#9733;
                      </span>
                    </ng-template>
                  </ngb-rating>
                </h2>

                <!-- Comment -->
                <div class="form-group">
                  <label for="textareaComment">
                    Comment (optional)
                  </label>
                  <textarea
                    class="form-control"
                    id="textareaComment"
                    placeholder="Enter comment"
                    rows="3"
                    formControlName="comment">
                  </textarea>
                </div>

                <!-- Actions -->
                <div class="btn-group" role="group">

                  <!-- Cancel reviewing -->
                  <button
                    type="button"
                    class="btn btn-danger"
                    (click)="selectedTransactionForReview = -1">
                      Cancel Review
                  </button>

                  <!-- Post review -->
                  <button
                    class="btn btn-success"
                    [disabled]="rating === 0">
                      Post Review
                  </button>

                </div>

              </form>
            </div>

          </div>

          <!-- No results -->
          <div *ngIf="lst.length === 0">
            <b>No {{transactions ? 'Transactions' : 'Listings'}} Found</b>
          </div>

        </div>
      </div>

       <!-- Row containing Page navigation -->
       <div class="row" *ngIf="lst.length > 0">
        <!-- Trick to allow right alligning -->
        <div class="col"></div>
        <!-- Page navigation -->
        <ng-container *ngTemplateOutlet="pages"></ng-container>
      </div>
</div>



<!-- PAGE IF USER NOT LOGGED IN -->
<app-login *ngIf="!user.isLoggedIn()"></app-login>

